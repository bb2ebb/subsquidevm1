# Installation and Dependancies
Install Node.js and Docker. For windows user, Docker can download in https://docs.docker.com/desktop/install/windows-install and Nodejs can download in https://nodejs.org/en/download <br/>
<b>Note: please use your PC, because docker does not support in android anything</b>

```bash
sudo apt-get update
sudo apt-get install node nodejs npm docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
npm i -g @subsquid/cli
npm ci
```
<br/>
For additional dependency installations, you can install this to ensure your work runs smoothly without obstacles in the future. 

```bash
npm i -g @types/node
npm i -g typescript
npm i -g @subsquid/archive-registry
npm i -g @subsquid/big-decimal
npm i -g @subsquid/bigquery-store
npm i -g @subsquid/bn-typeorm
npm i -g @subsquid/cli
npm i -g @subsquid/commands
npm i -g @subsquid/csv-store
npm i -g @subsquid/duckdb-store
npm i -g @subsquid/eth-ingest
npm i -g @subsquid/evm-ingest
npm i -g @subsquid/evm-processor
npm i -g @subsquid/evm-typegen
npm i -g @subsquid/file-store
npm i -g @subsquid/file-store-csv
npm i -g @subsquid/file-store-json
npm i -g @subsquid/file-store-parquet
npm i -g @subsquid/file-store-s3
npm i -g @subsquid/frontier
npm i -g @subsquid/graphiql-console
npm i -g @subsquid/graphql-server
npm i -g @subsquid/gsheets-store
npm i -g @subsquid/http-client
npm i -g @subsquid/hydra-cli
npm i -g @subsquid/hydra-common
npm i -g @subsquid/hydra-db-utils
npm i -g @subsquid/hydra-processor
npm i -g @subsquid/hydra-typegen
npm i -g @subsquid/ink-abi
npm i -g @subsquid/ink-typegen
npm i -g @subsquid/logger
npm i -g @subsquid/openreader
npm i -g @subsquid/rpc-client
npm i -g @subsquid/scale-codec
npm i -g @subsquid/scale-codec-json
npm i -g @subsquid/scale-type-system
npm i -g @subsquid/squid-gen
npm i -g @subsquid/squid-gen-evm
npm i -g @subsquid/squid-gen-ink
npm i -g @subsquid/squid-gen-targets
npm i -g @subsquid/squid-gen-utils
npm i -g @subsquid/ss58
npm i -g @subsquid/ss58-codec
npm i -g @subsquid/substrate-data
npm i -g @subsquid/substrate-data-raw
npm i -g @subsquid/substrate-dump
npm i -g @subsquid/substrate-evm-processor
npm i -g @subsquid/substrate-frontier-evm
npm i -g @subsquid/substrate-ingest
npm i -g @subsquid/substrate-metadata
npm i -g @subsquid/substrate-metadata-explorer
npm i -g @subsquid/substrate-processor
npm i -g @subsquid/substrate-runtime
npm i -g @subsquid/substrate-typegen
npm i -g @subsquid/typeorm-codegen
npm i -g @subsquid/typeorm-config
npm i -g @subsquid/typeorm-migration
npm i -g @subsquid/typeorm-store
npm i -g @subsquid/util
npm i -g @subsquid/util-internal
npm i -g @subsquid/util-internal-archive-client
npm i -g @subsquid/util-internal-archive-layout
npm i -g @subsquid/util-internal-binary-heap
npm i -g @subsquid/util-internal-code-printer
npm i -g @subsquid/util-internal-commander
npm i -g @subsquid/util-internal-config
npm i -g @subsquid/util-internal-counters
npm i -g @subsquid/util-internal-fs
npm i -g @subsquid/util-internal-gql-request
npm i -g @subsquid/util-internal-hex
npm i -g @subsquid/util-internal-http-client
npm i -g @subsquid/util-internal-http-server
npm i -g @subsquid/util-internal-ingest-tools
npm i -g @subsquid/util-internal-json
npm i -g @subsquid/util-internal-processor-tools
npm i -g @subsquid/util-internal-prometheus-server
npm i -g @subsquid/util-internal-range
npm i -g @subsquid/util-internal-read-lines
npm i -g @subsquid/util-internal-resilient-rpc
npm i -g @subsquid/util-internal-service-manager
npm i -g @subsquid/util-naming
npm i -g @subsquid/util-timeout
npm i -g @subsquid/util-xxhash
npm i -g @subsquid/warthog
```

<br/><br/>

# Deploy an evm squid
#### 1. Login into subsquid aquarium network account https://app.subsquid.io/squids and setting your organization code
#### 2. Copy paste code below
format of code

```bash
sqd auth -k sqd_12345abcdef
sqd init <your_squid_name> -t evm
cd <your_squid_name>
sqd deploy --org <your_organizationcode> ./<your_squid-name>
```
your_organizationcode = your organizationcode generated by your squid account

sqd_12345abcdef = your secret login in https://app.subsquid.io/squids

<br/>

###### Here's a direct example

```bash
sqd auth -k sqd_12345abcdefsecret
sqd init subsquidevm1 -t evm
sqd deploy --org secret-organizationcode ./subsquidevm1
```

<br/><br/>

# Migrate ENS Subgraph
#### 1. Still using the last tutorial where we ["deploy an EVM Squid"](#deploy-an-evm-squid)
#### 2. Still using the last folder "subsquidevm1"

```bash
cd subsquidevm1
```

#### 3. Update the "schema.graphql" located in the "./subsquidevm1/" folder to the code below.

```bash
type Gravatar @entity {
  id: ID!
  owner: String!
  displayName: String!
  imageUrl: String!
}
```

#### 4. In the folder "./subsquidevm1/abi/" create file named "Gravity.json" and add code like as below

```bash
[{"constant":false,"inputs":[{"name":"_imageUrl","type":"string"}],"name":"updateGravatarImage","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"setMythicalGravatar","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"owner","type":"address"}],"name":"getGravatar","outputs":[{"name":"","type":"string"},{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"gravatarToOwner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"ownerToGravatar","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_displayName","type":"string"}],"name":"updateGravatarName","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_displayName","type":"string"},{"name":"_imageUrl","type":"string"}],"name":"createGravatar","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"gravatars","outputs":[{"name":"owner","type":"address"},{"name":"displayName","type":"string"},{"name":"imageUrl","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"name":"id","type":"uint256"},{"indexed":false,"name":"owner","type":"address"},{"indexed":false,"name":"displayName","type":"string"},{"indexed":false,"name":"imageUrl","type":"string"}],"name":"NewGravatar","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"id","type":"uint256"},{"indexed":false,"name":"owner","type":"address"},{"indexed":false,"name":"displayName","type":"string"},{"indexed":false,"name":"imageUrl","type":"string"}],"name":"UpdatedGravatar","type":"event"}]
```

Optionally: you can clean up the code to make it look better.

#### 5. In the folder "./subsquidevm1/src/" there is file named "processor.ts" and add code like as below

```bash
.addLog({
   address: ['0x2E645469f354BB4F5c8a05B3b30A929361cf77eC'],
})
```

Place the code after `.addTransaction` , still confuse you can looks picture below.
![tes](https://i.imgur.com/H0sz4nc.png)

#### 6. In the bash terminal, type:
```bash
sqd typegen
```

If successful, you will see output like this.

![aa](https://i.imgur.com/mKwgNED.png)

#### 7. Update your "processor.ts" again who located in "./subsquidevm1/src/" using code like as below. copy paste all in:
```bash
import {lookupArchive} from '@subsquid/archive-registry';
import {
    BlockHeader,
    DataHandlerContext,
    EvmBatchProcessor,
    EvmBatchProcessorFields,
    Log as _Log,
    Transaction as _Transaction,
} from '@subsquid/evm-processor';
import * as Gravatar from './abi/Gravity';
export const processor = new EvmBatchProcessor()
    .setDataSource({
        // Change the Archive endpoints for run the squid
        // against the other EVM networks
        // For a full list of supported networks and config options
        // see https://docs.subsquid.io/evm-indexing/
        archive: lookupArchive('eth-mainnet'),

        // Must be set for RPC ingestion (https://docs.subsquid.io/evm-indexing/evm-processor/)
        // OR to enable contract state queries (https://docs.subsquid.io/evm-indexing/query-state/)
        chain: 'https://rpc.ankr.com/eth',
    })
    .setFinalityConfirmation(75)
    .setFields({
        transaction: {
            from: true,
            value: true,
            hash: true,
        },
    })
    .setBlockRange({
        from: 6_000_000,
    })

    .addLog({
        address: ['0x2E645469f354BB4F5c8a05B3b30A929361cf77eC'],
        topic0: [
          Gravatar.events.NewGravatar.topic,
          Gravatar.events.UpdatedGravatar.topic
        ],
    });


export type Fields = EvmBatchProcessorFields<typeof processor>;
export type Block = BlockHeader<Fields>;
export type Log = _Log<Fields>;
export type Transaction = _Transaction<Fields>;
export type ProcessorContext<Store> = DataHandlerContext<Store, Fields>;
```

#### 8. In the bash terminal, type:
```bash
sqd codegen
```

If successful, you will see output like this.

![aa](https://i.imgur.com/q67WWEO.png)
